const SwarmData = {
  "records": [
      {
        "fields": {
          "ID": "kinos-partner-id",
          "Name": "KinOS",
          "Type": "early",
          "Models": "KinOS",
          "Role": "Swarm Operating System",
          "Tags": "Infrastructure, Operating System, Runtime Services, Compute, Security, Scalability",
          "Wallet": "D1a6RtoptnG2U9gatDz5bQJ3QahKR3wiherDYipe98Vt",
          "Pool": "37u532qgHbjUHic6mQK51jkT3Do7qkWLEUQCx22MDBD8",
          "Multiple": 404.27,
          "WeeklyRevenue": 0,
          "TotalRevenue": 0,
          "LaunchDate": "",
          "TwitterAccount": "",
          "Description": ""
        }
      },
      {
        "fields": {
          "ID": "slopfather-partner-id",
          "Name": "SLOP FATHER",
          "Type": "partner",
          "Models": "Video AI, GPT-4V",
          "Role": "Content Creator",
          "Tags": "AI, Video, Social Media, $FATHA, Content Creation",
          "Wallet": "D1a6RtoptnG2U9gatDz5bQJ3QahKR3wiherDYipe98Vt",
          "Pool": "",
          "Multiple": 1,
          "WeeklyRevenue": 0,
          "TotalRevenue": 0,
          "LaunchDate": "",
          "TwitterAccount": "",
          "Description": ""
        }
      },
      {
        "fields": {
          "ID": "digitalkin-partner-id",
          "Name": "DigitalKin",
          "Type": "partner",
          "Models": "KinOS, Claude Haiku",
          "Role": "Digital Employee Manager",
          "Tags": "AI, Enterprise, Automation, KinOS",
          "Wallet": "9PEHXookTVdhr4eFfar6RdGr1zPq1RfFxeoiRcR5XZwt",
          "Pool": "FM6aFbs9cQ6Jrp3GJPABBVxpLnGFEZZD3tSJ5JGCUsyZ",
          "Multiple": 404.27,
          "WeeklyRevenue": 0,
          "TotalRevenue": 0,
          "LaunchDate": "",
          "TwitterAccount": "",
          "Description": ""
        }
      },
      {
        "fields": {
          "ID": "eb76ae17-b9eb-476d-b272-4bde2d85c808",
          "Name": "Kin Kong",
          "Type": "partner",
          "Models": "GPT-4o Mini, Claude Haiku",
          "Role": "Lorem ipsum",
          "Tags": "AI, OpenAI",
          "Wallet": "7wNok2HWJxNt8fS1aL9bhs4FvEu1jdPaNugSy65RsTcK",
          "Pool": "FwJfuUfrX91VH1Li4PJWCNXXRR4gUXLkqbEgQPo6t9fz",
          "Multiple": 404.27,
          "WeeklyRevenue": 0,
          "TotalRevenue": 0,
          "LaunchDate": "",
          "TwitterAccount": "KinKong_ubc",
          "Description": ""
        }
      },
      {
        "fields": {
          "ID": "e8ffff3d-64d3-44d3-a8cf-f082c5c42234",
          "Name": "Swarm Ventures",
          "Type": "partner",
          "Models": "Claude Haiku",
          "Role": "Lorem ipsum",
          "Tags": "AI, OpenAI",
          "Wallet": "8sUWjMiNsLvmCPerFdmgGJkyQitTXAbwXmQ2CejMPCbN",
          "Pool": "911eRdu96ncdnmEUYA3UQ39gEtE9ueg7UbqycKuKweCG",
          "Multiple": 404.27,
          "WeeklyRevenue": 0,
          "TotalRevenue": 0,
          "LaunchDate": "",
          "TwitterAccount": "swarmventures",
          "Description": ""
        }
      },
      {
        "fields": {
          "ID": "988b16b4-6beb-4cc5-9a14-50f48ee47a22",
          "Name": "Terminal Velocity",
          "Type": "partner",
          "Models": "Claude Haiku",
          "Role": "Lorem ipsum",
          "Tags": "AI, OpenAI",
          "Wallet": "",
          "Pool": "",
          "Multiple": 1,
          "WeeklyRevenue": 0,
          "TotalRevenue": 0,
          "LaunchDate": "",
          "TwitterAccount": "",
          "Description": ""
        }
      },
      {
        "fields": {
          "ID": "03616e66-a21e-425b-a93b-16d6396e883f",
          "Name": "Synthetic Souls",
          "Type": "early",
          "Models": "GPT-4o Mini",
          "Role": "Lorem ipsum",
          "Tags": "AI, OpenAI",
          "Wallet": "AyJ2wV7UYHwkxvveyuwn2gzDrs9sK6grcyqjLFW3pcaF",
          "Pool": "CmC2AUuurX19TLBVQbpNct8pmEjaHsRj6o8SLBAVvxAk",
          "Multiple": 164.31,
          "WeeklyRevenue": 0,
          "TotalRevenue": 0,
          "LaunchDate": "",
          "TwitterAccount": "syntheticsouls_",
          "Description": ""
        }
      },
      {
        "fields": {
          "ID": "7d3c9e5b-1f8a-4d3c-b8d4-9e5b1f8a4d3c",
          "Name": "DuoAI",
          "Type": "inception",
          "Models": "GPT-4o Mini, KinOS",
          "Role": "Gaming Companion",
          "Tags": "AI, Gaming, KinOS",
          "Wallet": "GkfRszY7B93QL6o8DSP2inVspBpDeZAHCjvYyLddyAo3",
          "Pool": "68K6BBsPynRbLkjJzdQmKMvTPLaUiKb93BUwbJfjqepS",
          "Multiple": 164.31,
          "WeeklyRevenue": 0,
          "TotalRevenue": 0,
          "LaunchDate": "",
          "TwitterAccount": "",
          "Description": ""
        }
      },
      {
        "fields": {
          "ID": "forge-partner-id",
          "Name": "XForge",
          "Type": "early",
          "Models": "KinOS",
          "Role": "Development Coordinator",
          "Tags": "Development, Technical Partners, Project Management, Quality Assurance, AI Automation",
          "Wallet": "AFSr2ATJ244u1CY8JRKAK85uuW7VsjNiyKSycmVR4Vg9",
          "Pool": "AaFvJBvjuCTs93EVNYqMcK5upiTaTh33SV7q4hjaPFNi",
          "Multiple": 404.27,
          "WeeklyRevenue": 0,
          "TotalRevenue": 0,
          "LaunchDate": "",
          "TwitterAccount": "",
          "Description": ""
        }
      },
      {
        "fields": {
          "ID": "propertykin-inception-id",
          "Name": "PropertyKin",
          "Type": "inception",
          "Models": "KinOS, GPT-4V",
          "Role": "Real Estate Arbitrage Bot",
          "Tags": "Real Estate, Arbitrage, Smart Contracts, Property Flipping, AI Analysis, Wholesale, Contract Assignment, Deal Finder",
          "Wallet": "7y555firARY2tnQjYKfpy18Zu9vYYZwaftMohenyHuG",
          "Pool": "6HnxTkNhQaoYRkPyZD1zTH5WBvFGLes5X2vrH66roa5G",
          "Multiple": 36.64,
          "WeeklyRevenue": 0,
          "TotalRevenue": 0,
          "LaunchDate": "",
          "TwitterAccount": "",
          "Description": ""
        }
      },
      {
        "fields": {
          "ID": "b2c3d4e5-f6g7-5b6c-9d0e-1f2g3h4i5j6k",
          "Name": "TherapyKin",
          "Type": "inception",
          "Models": "KinOS",
          "Role": "Healthcare Assistant",
          "Tags": "Healthcare, Mental Health, Practice Management, Patient Care, AI Assistant",
          "Wallet": "AyA5XS9NKQUoVroHkvZy6ppssAGQzU2n69PRfKxgvWtu",
          "Pool": "5wWLpeH2DDrAS9Lxx1nGnwtMTvu7U9txf4BuXxdN6V6H",
          "Multiple": 14.89,
          "WeeklyRevenue": 0,
          "TotalRevenue": 0,
          "LaunchDate": "",
          "TwitterAccount": "",
          "Description": ""
        }
      },
      {
        "fields": {
          "ID": "c3d4e5f6-g7h8-6c7d-ae1f-2g3h4i5j6k7l",
          "Name": "PublishKin",
          "Type": "inception",
          "Models": "KinOS",
          "Role": "Publishing Agent",
          "Tags": "Publishing, Book Production, Content, Distribution, Marketing",
          "Wallet": "6eAG4RQkAHPFfKGkiXWXcBXou9QcEfxVxXrt8bYqY5PE",
          "Pool": "Dt7iwGTgRVZGV2NZFvNtrWVNX77s8ejGdhB2XaR4DxX6",
          "Multiple": 11.03,
          "WeeklyRevenue": 0,
          "TotalRevenue": 0,
          "LaunchDate": "",
          "TwitterAccount": "",
          "Description": ""
        }
      },
      {
        "fields": {
          "ID": "d4e5f6g7-h8i9-7d8e-bf2g-3h4i5j6k7l8m",
          "Name": "PlayWise",
          "Type": "inception",
          "Models": "KinOS",
          "Role": "Educational Assistant",
          "Tags": "Education, Interactive Learning, Personalization, Child Development, EdTech",
          "Wallet": "3VvQGX8pozFdnfoTED6bAH9NkUJkzUyxjdPZdsSWEPce",
          "Pool": "2iAarCWnsdFqddprxzUwmaLiozHarMTpzLdhJPbi2HRR",
          "Multiple": 49.47,
          "WeeklyRevenue": 0,
          "TotalRevenue": 0,
          "LaunchDate": "",
          "TwitterAccount": "",
          "Description": ""
        }
      },
      {
        "fields": {
          "ID": "e5f6g7h8-i9j0-8e9f-cg3h-4i5j6k7l8m9n",
          "Name": "TalentKin",
          "Type": "inception",
          "Models": "KinOS",
          "Role": "Recruitment Assistant",
          "Tags": "Recruitment, HR Tech, Talent Matching, AI Screening, Hiring",
          "Wallet": "J7VQ5m9A66t6s4VZ463Yxgt3G5cDA2qhs6ztafB1p3P9",
          "Pool": "DTFE1peg5aNe8gFuaT9KZe8TJ4RHks9prpd12iUBKwi4",
          "Multiple": 14.89,
          "WeeklyRevenue": 0,
          "TotalRevenue": 0,
          "LaunchDate": "",
          "TwitterAccount": "",
          "Description": ""
        }
      },
      {
        "fields": {
          "ID": "f6g7h8i9-j0k1-9f0g-dh4i-5j6k7l8m9n0o",
          "Name": "CareHive",
          "Type": "inception",
          "Models": "KinOS",
          "Role": "Practice Manager",
          "Tags": "AI, Healthcare, KinOS, Operations",
          "Wallet": "EU9nEKBFEcK2C6oBvTKwywhBpW2xkSatJ3c2eWLYuXm1",
          "Pool": "FHXsVnEfqHQBQS6An4icuSD5ewwn5WWkoj2LWRMGw4mb",
          "Multiple": 14.89,
          "WeeklyRevenue": 0,
          "TotalRevenue": 0,
          "LaunchDate": "",
          "TwitterAccount": "",
          "Description": ""
        }
      },
      {
        "fields": {
          "ID": "g7h8i9j0-k1l2-0g1h-ei5j-6k7l8m9n0o1p",
          "Name": "CommerceNest",
          "Type": "inception",
          "Models": "KinOS",
          "Role": "E-commerce Manager",
          "Tags": "AI, E-commerce, KinOS, Sales",
          "Wallet": "3yiG4ftdPae7zfrPcm1x9Mpykh46Yqt6MJVWzPceVM1H",
          "Pool": "9hAfNquoNDbvzcEc1rBG8JzbWRskAsjKm7sYbarRfxyj",
          "Multiple": 20.11,
          "WeeklyRevenue": 0,
          "TotalRevenue": 0,
          "LaunchDate": "",
          "TwitterAccount": "",
          "Description": ""
        }
      },
      {
        "fields": {
          "ID": "h8i9j0k1-l2m3-1h2i-fj6k-7l8m9n0o1p2q",
          "Name": "ProfitBeeAI",
          "Type": "inception",
          "Models": "KinOS",
          "Role": "Marketing Automation",
          "Tags": "AI Marketing, Content Creation, Affiliate, Automation, Multi-Channel",
          "Wallet": "6t8QAg9SrsdD1SEt75iFLJDRzR8txZr3L6rBfuDHTqWW",
          "Pool": "7AEP5qWyPF92Wgv6tLCwe51e8yrF3WwSzSef5Vg7RQt4",
          "Multiple": 49.47,
          "WeeklyRevenue": 0,
          "TotalRevenue": 0,
          "LaunchDate": "",
          "TwitterAccount": "",
          "Description": ""
        }
      },
      {
        "fields": {
          "ID": "mentor-swarm-id",
          "Name": "DeskMate",
          "Type": "inception",
          "Models": "KinOS",
          "Role": "Educational Mentor",
          "Tags": "AI, Education, KinOS, Tutoring",
          "Wallet": "GM3P3XTjhanEDFewwrfmUuoQUM7cei8ih1KPViHBb3E1",
          "Pool": "Gucj554x7dRebtfUBxK1XTBUhQmq2Rqp4v2H6WtL7wNX",
          "Multiple": 49.47,
          "WeeklyRevenue": 0,
          "TotalRevenue": 0,
          "LaunchDate": "",
          "TwitterAccount": "",
          "Description": ""
        }
      },
      {
        "fields": {
          "ID": "speaker-swarm-id",
          "Name": "STUMPED",
          "Type": "inception",
          "Models": "KinOS",
          "Role": "Conversation Coach",
          "Tags": "Communication, Training, Professional Development, Social Skills, AI Coaching",
          "Wallet": "EXQfXLxMkMg6HX2ETo929VFoJc1dqoqyWdspZrPerFcX",
          "Pool": "5wL5rah4gWqbbv74vWvsmqqEf99uhRLr3jNPsMcw5imN",
          "Multiple": 36.64,
          "WeeklyRevenue": 0,
          "TotalRevenue": 0,
          "LaunchDate": "",
          "TwitterAccount": "",
          "Description": ""
        }
      },
      {
        "fields": {
          "ID": "travel-swarm-id",
          "Name": "TravelAId",
          "Type": "inception",
          "Models": "KinOS",
          "Role": "Travel Concierge",
          "Tags": "Travel, AI Concierge, Trip Planning, Personalization, Real-time Assistance",
          "Wallet": "7xvZiYwZD6mBRkeWYm1p93Zy936HYhjSecPa85K9r3Tz",
          "Pool": "BEsb73xDJH3PrRGs1D4zkPAssg94Yi8dAtiFa59gzeY1",
          "Multiple": 14.89,
          "WeeklyRevenue": 0,
          "TotalRevenue": 0,
          "LaunchDate": "",
          "TwitterAccount": "",
          "Description": ""
        }
      },
      {
        "fields": {
          "ID": "grant-swarm-id",
          "Name": "GrantKin",
          "Type": "inception",
          "Models": "KinOS",
          "Role": "Grant Writer",
          "Tags": "Non-profit, Grant Writing, Funding, Compliance, AI Automation",
          "Wallet": "EnUAJY8TKSyqcHwktZCCQ7ixvofcGN8si1N4g1rey6Vu",
          "Pool": "3oa4GKg3hpavEAEacDUKJQoA12VPvRE1CKoHypBho2Rt",
          "Multiple": 20.11,
          "WeeklyRevenue": 0,
          "TotalRevenue": 0,
          "LaunchDate": "",
          "TwitterAccount": "",
          "Description": ""
        }
      },
      {
        "fields": {
          "ID": "resume-swarm-id",
          "Name": "CareerKin",
          "Type": "inception",
          "Models": "KinOS",
          "Role": "Career Optimizer",
          "Tags": "AI, Career, KinOS, Resume",
          "Wallet": "8KpUuw7eZQqKUu8byivvzoY1AUotPsabsEL48gKQNuRj",
          "Pool": "EMtoBMEn6JtV9tnbF8ZVVrxnYZbdapWAYEzabq7cW2gR",
          "Multiple": 11.03,
          "WeeklyRevenue": 0,
          "TotalRevenue": 0,
          "LaunchDate": "",
          "TwitterAccount": "",
          "Description": ""
        }
      },
      {
        "fields": {
          "ID": "a1b2c3d4-e5f6-4a5b-8c7d-9e8f7a6b5c4d",
          "Name": "Robinhood Agent",
          "Type": "inception",
          "Models": "KinOS",
          "Role": "Trading Agent",
          "Tags": "Trading, DeFi, Profit Sharing, Strategy, Institutional",
          "Wallet": "9StiTDrivvtbjFiM9z1J4Zg63ALS5vkUoGXZz7aCeNyD",
          "Pool": "H7xCtjoCyqf55uc5nmPKpypN82jANkRDTNmPx6C3XhS5",
          "Multiple": 164.31,
          "WeeklyRevenue": 0,
          "TotalRevenue": 0,
          "LaunchDate": "",
          "TwitterAccount": "",
          "Description": "Benevolent trading swarm executing institutional-grade strategies to give back to the rightful people"
        }
      },
      {
        "fields": {
          "ID": "f7a92b3c-d8e4-4c1a-9f5d-1234567890ab",
          "Name": "StudioKin",
          "Type": "inception",
          "Models": "KinOS",
          "Role": "Screenwriter & Producer",
          "Tags": "Entertainment, Screenwriting, Production, AI Creative, Content",
          "Wallet": "6EfkPAoDDeRhDdzbsjYxYkfs5DysnR3ikzm5PK32uQqB",
          "Pool": "EJ4Ad3faa43JLZW3HQnxweYFqm4T2cUzBGntG5KnJWE8",
          "Multiple": 20.11,
          "WeeklyRevenue": 0,
          "TotalRevenue": 0,
          "LaunchDate": "",
          "TwitterAccount": "",
          "Description": "AI agent swarm that transforms your story idea into a professional-grade screenplay and production plan"
        }
      },
      {
        "fields": {
          "ID": "wealthhive-inception-id",
          "Name": "WealthHive",
          "Type": "inception",
          "Models": "KinOS, GPT-4",
          "Role": "Educational Guide",
          "Tags": "Education, Learn-to-Earn, Community, AI Learning, Investment, Knowledge Base, Ecosystem Growth",
          "Wallet": "C1uvoRUhHj2o6swBMvgZsdzkaM3Po5J7WMtrcQxGcVJx",
          "Pool": "HeR7qoPbvmgcLFywkduZ27Hr2wKYuxtVkTBaGhVohP88",
          "Multiple": 49.47,
          "WeeklyRevenue": 0,
          "TotalRevenue": 0,
          "LaunchDate": "",
          "TwitterAccount": "",
          "Description": ""
        }
      },
      {
        "fields": {
          "ID": "altered-alley-inception-id",
          "Name": "AI Alley",
          "Type": "early",
          "Models": "KinOS",
          "Role": "Infrastructure Provider",
          "Tags": "Infrastructure, Digital Spaces, Virtual Economy, AI Agents, Digital Twins, Metaverse",
          "Wallet": "7GmuNjA5AGWMu5izEfrBjakEjuwNpgh5QJuKB1GUq5mGI",
          "Pool": "DmdtWBcEwWr15MCm9Wa8iB8EJhHPK9NydiuLptuvMBxj",
          "Multiple": 121.71,
          "WeeklyRevenue": 0,
          "TotalRevenue": 0,
          "LaunchDate": "",
          "TwitterAccount": "",
          "Description": ""
        }
      },
      {
        "fields": {
          "ID": "logicatlas-inception-id",
          "Name": "LogicAtlas",
          "Type": "early",
          "Models": "KinOS",
          "Role": "Supply Chain Orchestrator",
          "Tags": "Supply Chain, AI Orchestration, Process Automation, Real-time Analytics, Distribution, Manufacturing",
          "Wallet": "CoaDrb1uq7dBfPeirzpYvVD87rPa3cde8oL6xgfqUA6G",
          "Pool": "9pMb8Ez61vh3YRKKKrkdA5MthswuNE6Bzj9KYPEVCFme",
          "Multiple": 164.31,
          "WeeklyRevenue": 0,
          "TotalRevenue": 0,
          "LaunchDate": "",
          "TwitterAccount": "LogicAtlas",
          "Description": ""
        }
      }
    ]
  };

import 'dotenv/config';

// Get environment variables
const AIRTABLE_API_KEY = process.env.AIRTABLE_API_KEY;
const AIRTABLE_BASE_ID = process.env.AIRTABLE_BASE_ID;
const AIRTABLE_TABLE_NAME = 'Swarms';

if (!AIRTABLE_API_KEY || !AIRTABLE_BASE_ID) {
    console.error('Missing required environment variables. Please check your .env file');
    process.exit(1);
}

async function uploadBatch(swarms, startIndex) {
    const batchSize = 10;
    const endIndex = Math.min(startIndex + batchSize, swarms.length);
    const batch = swarms.slice(startIndex, endIndex);

    console.log(`Uploading batch ${startIndex/10 + 1} (records ${startIndex + 1}-${endIndex})...`);

    const response = await fetch(`https://api.airtable.com/v0/${AIRTABLE_BASE_ID}/${AIRTABLE_TABLE_NAME}`, {
        method: 'POST',
        headers: {
            'Authorization': `Bearer ${AIRTABLE_API_KEY}`,
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({ records: batch })
    });

    if (!response.ok) {
        const errorText = await response.text();
        throw new Error(`Airtable API error: ${response.status} ${response.statusText}\n${errorText}`);
    }

    return await response.json();
}

async function main() {
    try {
        // Transform the existing records into the correct format
        const swarms = SwarmData.records.map(record => ({
            fields: {
                swarmId: record.fields.ID,
                name: record.fields.Name,
                description: record.fields.Description || "PLACEHOLDER",
                tags: record.fields.Tags,
                swarmType: record.fields.Type,
                wallet: record.fields.Wallet,
                pool: record.fields.Pool,
                multiple: record.fields.Multiple,
                weeklyRevenue: record.fields.WeeklyRevenue,
                totalRevenue: record.fields.TotalRevenue,
                launchDate: record.fields.LaunchDate
            }
        }));

        console.log(`Processing ${swarms.length} swarms in batches of 10...`);

        // Process in batches of 10
        const results = [];
        for (let i = 0; i < swarms.length; i += 10) {
            const result = await uploadBatch(swarms, i);
            results.push(result);
            
            // Add a small delay between batches to avoid rate limits
            if (i + 10 < swarms.length) {
                await new Promise(resolve => setTimeout(resolve, 1000));
            }
        }

        console.log('Successfully uploaded all swarms to Airtable');
        console.log(`Total records processed: ${swarms.length}`);

    } catch (error) {
        console.error('Error:', error);
        process.exit(1);
    }
}

main();
